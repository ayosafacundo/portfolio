version: '3.8'

services:
  app-server:
    # 1. Build context is the root directory
    build:
      context: .
      # 2. Specify the Dockerfile name (defaults to Dockerfile in context)
      dockerfile: Dockerfile
    
    # 3. Image name for use in Portainer/OneDev
    image: https://git.ayosafacundo.com.ar/portfolio:production
    
    # 4. Map the ports (Host Port 80 -> Container Port 5000)
    ports:
      - "80:5000"
    
    # 5. Restart policy for production reliability
    restart: unless-stopped
    
    # 6. Environment variables
    environment:
      NODE_ENV: production
      # Note: .env file is copied in the Dockerfile, but you can override here
      # You should secure sensitive variables using OneDev secrets instead of .env